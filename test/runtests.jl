using Wignerd
using Test

@testset "Wignerd.jl" begin
    @test Wignerd.alpha(10,2,3) ≈ 9.346657156438338

    cl = collect(1:11)
    glq = glquad(15)
    @test all(glq.w .≈ [0.03075324199611763,
                        0.07036604748810837,
                        0.107159220467172,
                        0.13957067792615432,
                        0.16626920581699403,
                        0.1861610000155622,
                        0.19843148532711158,
                        0.2025782419255613,
                        0.19843148532711158,
                        0.1861610000155622,
                        0.16626920581699403,
                        0.13957067792615432,
                        0.107159220467172,
                        0.07036604748810837,
                        0.03075324199611763])
    cf = cf_from_cl(glq, 1, 2, 10, cl)

    @test all(cf .≈ [0.48637200593039986,
                     2.488677425018759,
                     0.5069227587296468,
                     -1.7695498582535323,
                     1.2503571405011698,
                     0.5493888326422709,
                     -1.5079165544889677,
                     1.9124057254944156,
                     0.5280164782369949,
                     -1.377087728688859,
                     4.3518056862578165,
                     0.9142015051323855,
                     -0.7385994154342077,
                     22.7736581725636,
                     28.671569539955172])

    cl = cl_from_cf(glq, 3, 4, 10, cf)
    @test all(cl .≈ [0.0,
                     0.0,
                     0.0,
                     0.0,
                     1.3134048250068124,
                     1.076847756097337,
                     1.1038989013850293,
                     1.0676029242221057,
                     1.067067343762469,
                     1.054159429825423,
                     1.0511700259417847])
end
